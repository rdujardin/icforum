{% extends "forum/_base.html" %}
{% load bootstrap3 %}
{% block content %}
<div class="row">
	<div class="col-md-12">
		<h2>{{ topic }}</h2>
	</div>
</div>
<div class="row">
	<div class="col-md-12">
		{% for message in messages %}
			<div class="panel panel-default">
				{% if edit_message_pk != message.pk %}
					<div class="panel-heading"><a href="{% url 'user' pk=message.author.pk %}">{{ message.author }}</a> - {{ message.posted }} {% if message.edited != message.posted %}(edited : {{ message.edited }}){% endif %}{% if message.author.username == signed_in_user %}<a class="pull-right" href="{% url 'topic' pk=topic.pk edit_message=message.pk %}"><i class="fa fa-pencil" aria-hidden="true"></i></a>{% endif %}</div>
					<div class="panel-body">
						{{ message.content |safe }}
					</div>
				{% else %}
					<div class="panel-heading">Editing...<a class="pull-right" href="{% url 'topic' pk=topic.pk page=page %}">Cancel</a></div>
					<div class="panel-body">
						<form action="" method="post" novalidate>
							{% csrf_token %}
							<input type="hidden" name="edit_message_pk" value="{{ message.pk }}" />
							<input type="hidden" name="page" value="{{ page }}" />
							{% bootstrap_form edit_message_form %}
							{% buttons %}
								<button type="submit" class="btn btn-primary">
									{% bootstrap_icon 'start' %} Edit
								</button>
							{% endbuttons %}
						</form>
					</div>
				{% endif %}
			</div>
		{% endfor %}
	</div>
</div>
<div class="row">
	<div class="col-md-12">
		<nav aria-label="Page navigation" class="text-center">
			<ul class="pagination">
				{% for i in num_pages %}
					<li{% if i == page %} class="active"{% endif %}><a href="{% url 'topic' pk=topic.pk page=i %}">{{ i }}</a></li>
				{% endfor %}
			</ul>
		</nav>
	</div>
</div>
{% if new_message_form %}
	<div class="row">
		<div class="col-md-12">
			<form action="" method="post" novalidate>
				{% csrf_token %}
				<input type="hidden" name="page" value="{{ page }}" />
				{% bootstrap_form new_message_form %}
				{% buttons %}
					<button type="submit" class="btn btn-primary">
						{% bootstrap_icon 'star' %} Write
					</button>
				{% endbuttons %}
			</form>
		</div>
	</div>
{% endif %}
{% endblock %}